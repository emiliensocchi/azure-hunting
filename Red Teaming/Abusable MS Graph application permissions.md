# Abusable MS Graph application permissions

Collection of common application permissions in Microsoft Graph with their abusable information for Privilege Escalation (PE).


## Abusable application permission overview

| Application permission | Abusable for PE? | Explanation | Shortest path to Global Admin |
|---|---|---|---|
| [`AdministrativeUnit.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#administrativeunitreadwriteall) | Yes | Allows updating the membership of [Restricted Management Administrative Units (RMAU)](https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/admin-units-restricted-management). | n/a <br> Note: can help leveraging other types of access to take over a Global Admin that is protected by a RMAU. |
| [`Application.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#applicationreadwriteall) | Yes | Allows taking over any SP by creating a new secret for them. Can also assign new application permissions, but *cannot* grant them. | Find and take over another SP with more abusable permissions. |
| [`AppRoleAssignment.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#approleassignmentreadwriteall) | Yes | Allows assigning any application role to any SP *without* requiring admin consent. | Assign the [`RoleManagement.ReadWrite.Directory`](https://learn.microsoft.com/en-us/graph/permissions-reference#rolemanagementreadwritedirectory) permission to a compromised SP and abuse that permission to escalate to Global Admin. |
| [`Directory.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#directoryreadwriteall) <a id='directory-readwrite-all'></a> | Yes | Allows controlling group membership for: <ul><li>Non-role-assignable security groups with assigned Azure roles</li><li>Non-role-assignable M365 groups</li><li>Dynamic M365 groups via user creation</li><li>Dynamic security groups with assigned Azure roles via user creation</li></ul> Note: only provides permissions on directory objects (e.g. users, groups, applications, etc.) but *not* role assignments. <br>Cannot control group membership for role-assignable groups. <br>Cannot control ownership of application objects and SPs. | Identify and add a controlled user account to a non-role-assignable group with Tier-0 Azure permissions. With the new Azure permissions, identify compute resources with an assigned MI that has abusable MS Graph application permissions. Leverage the MI to escalate to Global Admin. |
| [`EntitlementManagement.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#entitlementmanagementreadwriteall) | Yes | Allows updating the assignment policy of arbitrary access packages, to successfully request them from a controlled user account without approval. <br> Can create new access packages, but adding resources to it such as Entra roles and groups requires extra permissions such as [`Group.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#groupreadwriteall) ([more info](https://learn.microsoft.com/en-us/graph/api/entitlementmanagement-post-accesspackageresourcerequests?view=graph-rest-beta&tabs=http#request-body)). | Identify an access package providing access to a security group with an active Global Admin assignment. Add an assignment policy to the access package, so that the latter can be requested from a controlled user account, without manual approval. With the controlled user, request the access package and escalate to Global Admin via group membership. |
| [`Group.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#groupreadwriteall) | Yes | Allows controlling group membership for: <ul><li>Non-role-assignable security groups with assigned Azure roles</li><li>Non-role-assignable M365 groups (members can read all conversations within the team by default)</li></ul> | Same as [`Directory.ReadWrite.All`](#directory-readwrite-all). |
[`PrivilegedAccess.ReadWrite.AzureAD`](https://learn.microsoft.com/en-us/graph/permissions-reference#privilegedaccessreadwriteazuread) | No | Legacy <br> Note: probably allowed to assign any Entra role to any user, by creating an active PIM role assignment in PIM iteration 1, using delegated permissions. Does not seem to have ever been usable as application permission (only delegated). | n/a |
| [`PrivilegedAccess.ReadWrite.AzureADGroup`](https://learn.microsoft.com/en-us/graph/permissions-reference#privilegedaccessreadwriteazureadgroup) <a id='privilegedaccess-readwrite-azureadgroup'></a> | Yes | Allows controlling the membership of role-assignable groups. <br>**Note**: requires the target to have an active license for PIM. | Add a controlled user account to a group that is actively assigned the Global Admin role, re-authenticates with the account and escalates to Global Admin. <br> Note: if the active group assignment requires MFA, this path may need to be combined with the [`RoleManagementPolicy.ReadWrite.AzureADGroup`](https://learn.microsoft.com/en-us/graph/permissions-reference#rolemanagementpolicyreadwriteazureadgroup) permission to be successful, depending on how the controlled user account was compromised. |
| [`PrivilegedAccess.ReadWrite.AzureResources`](https://learn.microsoft.com/en-us/graph/permissions-reference#privilegedaccessreadwriteazureresources) | No | Legacy <br> Note: probably allowed to assign Azure roles to any user on any scope in PIM iteration 1 and [2](https://learn.microsoft.com/en-us/graph/api/governanceroleassignmentrequest-post?view=graph-rest-beta&tabs=http), using delegated permissions. Does not seem to have ever been usable as application permission (only delegated). | n/a |
| [`PrivilegedEligibilitySchedule.ReadWrite.AzureADGroup`](https://learn.microsoft.com/en-us/graph/permissions-reference#privilegedeligibilityschedulereadwriteazureadgroup) <a id='privilegedeligibilityschedule-readwrite-azureadgroup'></a> | Yes | Allows making any user eligible to a group with an active Entra role assignment. <br>**Note**: requires the target to have an active license for PIM. | Make a controlled user account eligible to a group that is actively assigned the Global Admin role. Activate the group membership and escalates to Global Admin. <br>Note: if the eligible assignment or membership activation requires to meet specific requirements such as admin approval, this path needs to be combined with the [`RoleManagementPolicy.ReadWrite.AzureADGroup`](#rolemanagementpolicy-readwrite-azureadgroup) permission to be successful. |
[`RoleAssignmentSchedule.ReadWrite.Directory`](https://learn.microsoft.com/en-us/graph/permissions-reference#roleassignmentschedulereadwritedirectory) | Yes | Allows assigning any Entra role to any user, by creating an active PIM role assignment. <br>**Note**: requires the target to have an active license for PIM. | Assign the Global Admin role to a controlled user account, re-authenticate with the account and escalate to Global Admin. <br> Note: if the active role assignment requires MFA, this path may need to be combined with the [RoleManagementPolicy.ReadWrite.Directory](#rolemanagementpolicy-readwrite-directory) permission to be successful, depending on how the controlled user account was compromised. |
| [`RoleManagement.ReadWrite.Directory`](https://learn.microsoft.com/en-us/graph/permissions-reference#rolemanagementreadwritedirectory) | Yes | Allows assigning any Entra role to any security principal. | Assign the Global Admin role to a controlled security principal, re-authenticate with the principal and escalate to Global Admin. |
| [`RoleManagementPolicy.ReadWrite.AzureADGroup`](https://learn.microsoft.com/en-us/graph/permissions-reference#rolemanagementpolicyreadwriteazureadgroup) <a id='rolemanagementpolicy-readwrite-azureadgroup'></a> | Yes | Allows removing security constrains such as MFA requirements or admin approval for PIM group assignments and activations. <br>**Note**: requires the target to have an active license for PIM. | Can help leveraging [`PrivilegedEligibilitySchedule.ReadWrite.AzureADGroup`](#privilegedeligibilityschedule-readwrite-azureadgroup). |
| [`RoleManagementPolicy.ReadWrite.Directory`](https://learn.microsoft.com/en-us/graph/permissions-reference#rolemanagementpolicyreadwritedirectory) <a id='rolemanagementpolicy-readwrite-directory'></a> | Yes | Allows removing security constrains such as MFA requirements or admin approval for Entra role assignments and activations. <br>**Note**: requires the target to have an active license for PIM. | TA has compromised user credentials for an account that is eligible to the Global Admin role. TA updates the role's policy, so that no requirement needs to be met to activate the role. TA activates the role and escalates to Global Admin. |
| [`User.ReadWrite.All`](https://learn.microsoft.com/en-us/graph/permissions-reference#userreadwriteall) | Yes | Allows editing sensitive properties of any user account, such as "Employee ID" or "Department", and exploit dynamic groups based on those properties. <br> Cannot reset user passwords, without the principal also being assigned an appropriate Entra role (e.g. User Administrator or Privileged Authentication Administrator). | Identify a dynamic group with a membership rule based on a user property (e.g. department) and with assigned Azure permissions. Update the appropriate property of a controlled user account accordingly, to become part of the dynamic group. With the new Azure permissions, identify compute resources with an assigned MI that has abusable MS Graph application permissions. Leverage the MI to escalate to Global Admin. |
